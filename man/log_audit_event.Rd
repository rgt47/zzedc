% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/audit_logger.R, R/audit_logging.R
\name{log_audit_event}
\alias{log_audit_event}
\title{Log an audit event}
\usage{
log_audit_event(
  event_type,
  table_name,
  record_id = NULL,
  operation,
  details = NULL,
  user_id = NULL,
  db_path = NULL
)

log_audit_event(
  event_type,
  table_name,
  record_id = NULL,
  operation,
  details = NULL,
  user_id = NULL,
  db_path = NULL
)
}
\arguments{
\item{event_type}{Character: Type of event (INSERT, UPDATE, DELETE, SELECT, EXPORT, etc.)}

\item{table_name}{Character: Table affected}

\item{record_id}{Character: Record ID (optional)}

\item{operation}{Character: Description of operation}

\item{details}{Character: Additional details (JSON format)}

\item{user_id}{Character: User ID (optional)}

\item{db_path}{Character: Database path (optional)}

\item{audit_log}{reactiveVal object (from init_audit_log)}

\item{action}{Character - action type (e.g., "LOGIN", "DATA_EXPORT", "FORM_SUBMISSION")}

\item{resource}{Character - what was affected (e.g., "authentication", "subject_123", "report_export")}

\item{old_value}{Character - previous value (for modifications)}

\item{new_value}{Character - new value (for modifications)}

\item{status}{Character - success/failure}

\item{error_message}{Character - error details if status == "failure"}
}
\value{
Invisibly returns the new record (including hash)

Logical TRUE if successfully logged
}
\description{
Records an audit event with cryptographic chaining to previous record.

Records a database operation to the immutable audit trail.
}
\details{
Each audit event is:
\enumerate{
\item Assigned unique audit_id
\item Timestamped with timezone
\item Hashed using SHA-256
\item Linked to previous record (hash-chaining)
\item Made immutable by hash dependency
}
}
\examples{
\dontrun{
audit_log <- init_audit_log()
log_audit_event(
  audit_log,
  user_id = "john.doe",
  action = "LOGIN_ATTEMPT",
  resource = "authentication",
  status = "success"
)
}
\dontrun{
  log_audit_event(
    event_type = "INSERT",
    table_name = "subjects",
    record_id = "S001",
    operation = "New subject enrolled",
    details = '{"age": 65, "gender": "M"}',
    user_id = "jane_smith"
  )
}

}
