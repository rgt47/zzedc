% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/export_service.R
\name{prepare_export_data}
\alias{prepare_export_data}
\title{Data Export Service Layer}
\usage{
prepare_export_data(data_source, format, options = NULL, db_conn = NULL)
}
\arguments{
\item{data_source}{Character indicating data source ("edc", "all_files", "reports", "sample")}

\item{format}{Character specifying export format:
\itemize{
\item "csv": Comma-separated values
\item "xlsx": Excel workbook
\item "json": JSON format
\item "sas": SAS transport file (.xpt)
\item "spss": SPSS/PSPP format (.sav)
\item "stata": Stata format (.dta)
\item "rds": R serialized object (.rds)
\item "pdf": PDF document (requires template)
\item "html": HTML document (requires template)
}}

\item{options}{List of export options (metadata, timestamps, date_range, etc.)}

\item{db_conn}{Database connection (if data_source == "edc")}
}
\value{
List containing:
\itemize{
\item data: data.frame or list with export data
\item info: metadata about export (rows, columns, size estimate)
\item warnings: any issues encountered
}
}
\description{
Pure business logic for data export operations.
Separate from Shiny reactive code for testability and reusability.
Supports 8+ export formats: CSV, XLSX, JSON, PDF, HTML, SAS, SPSS, STATA, RDS
Prepare data for export
}
\details{
Retrieves and formats data based on export configuration.
Pure function with no Shiny dependencies.
}
\examples{
\dontrun{
export_result <- prepare_export_data(
  data_source = "edc",
  format = "csv",
  options = list(include_metadata = TRUE, include_timestamps = TRUE)
)
}
}
